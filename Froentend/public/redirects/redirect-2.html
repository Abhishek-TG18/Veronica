<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Restaurant Explorer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: #FFFFFF;
        }
    </style>
</head>
<body class="p-4 md:p-8">
    <div class="max-w-4xl mx-auto">
        <!-- Header Section -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-900 mb-4">Restaurant Explorer</h1>
            <p class="text-gray-600">Discover great restaurants around you</p>
        </div>

        <!-- Search Button -->
        <div class="flex justify-center mb-8">
            <button 
                id="findRestaurantsBtn"
                class="bg-orange-600 hover:bg-orange-700 text-white font-semibold py-3 px-8 rounded-full flex items-center gap-3 transform transition-transform hover:scale-105 shadow-lg"
            >
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"/>
                </svg>
                Find Nearby Restaurants
            </button>
        </div>

        <!-- Loading Indicator -->
        <div id="loadingIndicator" class="hidden">
            <div class="flex flex-col items-center justify-center space-y-4">
                <div class="animate-spin rounded-full h-12 w-12 border-4 border-orange-500 border-t-transparent"></div>
                <p class="text-orange-600">Finding delicious restaurants near you...</p>
            </div>
        </div>

        <!-- Error Message -->
        <div id="errorMessage" class="hidden mx-4 p-4 bg-red-50 text-red-600 rounded-lg border border-red-200"></div>

        <!-- Results Section -->
        <div id="resultsSection" class="hidden">
            <div class="mb-4 text-gray-900">
                <span id="resultCount" class="text-xl font-semibold"></span>
            </div>
            <div id="restaurantList" class="grid grid-cols-1 md:grid-cols-2 gap-6"></div>
        </div>
    </div>

    <script>
        const API_KEY = '33c12daa592a464fb22abecbcbcbd029';
        const findRestaurantsBtn = document.getElementById('findRestaurantsBtn');
        const loadingIndicator = document.getElementById('loadingIndicator');
        const errorMessage = document.getElementById('errorMessage');
        const restaurantList = document.getElementById('restaurantList');
        const resultsSection = document.getElementById('resultsSection');
        const resultCount = document.getElementById('resultCount');

        findRestaurantsBtn.addEventListener('click', findNearbyRestaurants);

        async function findNearbyRestaurants() {
            loadingIndicator.classList.remove('hidden');
            errorMessage.classList.add('hidden');
            resultsSection.classList.add('hidden');
            restaurantList.innerHTML = '';

            try {
                const position = await new Promise((resolve, reject) => {
                    navigator.geolocation.getCurrentPosition(resolve, reject);
                });

                const { latitude, longitude } = position.coords;

                const response = await fetch(
                    `https://api.geoapify.com/v2/places?categories=catering.restaurant&filter=circle:${longitude},${latitude},15000&bias=proximity:${longitude},${latitude}&limit=20&apiKey=${API_KEY}`
                );

                if (!response.ok) {
                    throw new Error('Failed to fetch restaurants');
                }

                const data = await response.json();
                displayRestaurants(data.features || []);
            } catch (err) {
                showError(err);
            } finally {
                loadingIndicator.classList.add('hidden');
            }
        }

        function displayRestaurants(restaurants) {
            resultsSection.classList.remove('hidden');
            
            if (restaurants.length === 0) {
                resultCount.textContent = 'No restaurants found in your area';
                return;
            }

            resultCount.textContent = `Found ${restaurants.length} restaurant${restaurants.length === 1 ? '' : 's'} near you`;

            restaurantList.innerHTML = restaurants.map(restaurant => {
                const props = restaurant.properties;
                return `
                    <div class="bg-white rounded-xl overflow-hidden hover:shadow-xl transition-all duration-300 border border-gray-200 shadow-sm">
                        <div class="p-6">
                            <div class="flex justify-between items-start">
                                <h3 class="font-bold text-xl text-gray-900 mb-2">${props.name || 'Unnamed Restaurant'}</h3>
                                ${props.rating ? 
                                    `<span class="bg-orange-100 text-orange-700 px-2 py-1 rounded-full text-sm font-medium">
                                        ★ ${props.rating}
                                    </span>` 
                                    : ''
                                }
                            </div>
                            
                            <div class="space-y-2 text-gray-600">
                                ${props.cuisine ? 
                                    `<p class="flex items-center gap-2">
                                        <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/>
                                        </svg>
                                        ${props.cuisine}
                                    </p>` 
                                    : ''
                                }

                                ${props.address_line1 ? 
                                    `<p class="flex items-center gap-2">
                                        <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                                        </svg>
                                        ${props.address_line1}
                                    </p>` 
                                    : ''
                                }
                                
                                ${props.city ? 
                                    `<p class="flex items-center gap-2">
                                        <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
                                        </svg>
                                        ${props.city}${props.postcode ? `, ${props.postcode}` : ''}
                                    </p>` 
                                    : ''
                                }
                                
                                ${props.distance ? 
                                    `<p class="flex items-center gap-2">
                                        <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"/>
                                        </svg>
                                        ${(props.distance / 1000).toFixed(1)} km away
                                    </p>` 
                                    : ''
                                }
                                
                                ${props.opening_hours ? 
                                    `<p class="flex items-center gap-2">
                                        <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                        </svg>
                                        ${props.opening_hours}
                                    </p>` 
                                    : ''
                                }
                            </div>

                            ${props.website || props.phone ? 
                                `<div class="mt-4 pt-4 border-t border-gray-100 flex gap-4">
                                    ${props.website ? 
                                        `<a href="${props.website}" target="_blank" 
                                            class="text-orange-600 hover:text-orange-700 text-sm flex items-center gap-1 font-medium">
                                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/>
                                            </svg>
                                            Website
                                        </a>` 
                                        : ''
                                    }
                                    ${props.phone ? 
                                        `<a href="tel:${props.phone}" 
                                            class="text-orange-600 hover:text-orange-700 text-sm flex items-center gap-1 font-medium">
                                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
                                            </svg>
                                            Call
                                        </a>` 
                                        : ''
                                    }
                                </div>`
                                : ''
                            }
                        </div>
                    </div>
                `;
            }).join('');
        }

        function showError(err) {
            errorMessage.classList.remove('hidden');
            if (err.code === 1) {
                errorMessage.textContent = '📍 Please enable location access to find nearby restaurants';
            } else {
                errorMessage.textContent = '❌ Error finding nearby restaurants. Please try again.';
                console.error('Error:', err);
            }
        }
    </script>
</body>
</html>